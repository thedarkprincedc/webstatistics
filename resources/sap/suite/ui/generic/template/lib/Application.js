sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/m/MessageToast","sap/m/ActionSheet","sap/m/Dialog","sap/m/Popover","sap/suite/ui/generic/template/lib/deletionHelper","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/ContextBookkeeping","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,H,a,M,A,b,P,d,r,C,t){"use strict";var c=(t.testableStatic(function(T,o){var s="sapUiSizeCozy",h="sapUiSizeCompact";if(o.hasClass(s)||o.hasClass(h)){return"";}else{return T?s:h;}},"Application_determineContentDensityClass")(D.support.touch,q(document.body)));function g(){return c;}function f(o,p){q.sap.syncStyleClass(c,p,o);p.addDependent(o);}var f=t.testableStatic(f,"Application_attachControlToParent");function e(T){var o=new C(T.oAppComponent);var l,E;function h(){return l;}function s(i){l=i;}function k(i){var j=T.oNavigationControllerProxy.getActiveComponents();return j.indexOf(i.getId())>=0;}var I=false;function p(j){if(I){return;}var i=0;for(;i<T.aRunningSideEffectExecutions.length&&!T.aRunningSideEffectExecutions[i];i++){i++;}if(T.aRunningSideEffectExecutions[i]){I=true;var h1=T.aRunningSideEffectExecutions[i];h1.then(function(){if(T.aRunningSideEffectExecutions[i]===h1){T.aRunningSideEffectExecutions[i]=null;}I=false;p(j);});}else{j();}}function m(i){var j;if(i instanceof b){j="open";}else if(i instanceof P||i instanceof A){j="openBy";}if(j){var h1=i[j];i[j]=function(){var i1=arguments;p(function(){if(!T.oBusyHelper.isBusy()){T.oBusyHelper.getUnbusy().then(function(){h1.apply(i,i1);});}});};}}var F={};function n(i,j,h1,i1,j1){i=i||T.oNavigationHost;var k1=i.getId();var l1=F[k1]||(F[k1]={});var m1=l1[j];if(!m1){m1=sap.ui.xmlfragment(k1,j,h1);f(m1,i);var n1;if(i1){n1=new J();m1.setModel(n1,i1);}(j1||q.noop)(m1,n1);l1[j]=m1;m(m1);}return m1;}function u(){return new Promise(function(i){T.oNavigationObserver.getProcessFinished(true).then(function(){T.oBusyHelper.getUnbusy().then(i);});});}function v(i){T.oShellServicePromise.then(function(j){j.setBackNavigation(i);});}function w(i){if(!T.oFlexibleColumnLayoutHandler){return{handleDataReceived:function(){return false;}};}return T.oFlexibleColumnLayoutHandler.getFclProxyForView(i);}var x=false;function y(i){x=i;}function z(i,j){if(!T.oFlexibleColumnLayoutHandler){return true;}var h1=r.determineNavigationPath(i,j);return T.oFlexibleColumnLayoutHandler.isNewHistoryEntryRequired(h1);}function R(i){T.aStateChangers.push(i);}function G(i){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getTargetAfterCancelPromise(i):Promise.resolve(i);}function K(i,j){j.then(function(){o.adaptAfterObjectDeleted(i);});}function L(i,j,h1){var i1=T.mEntityTree[i];var j1;if(i1.navigationProperty&&i1.parent){j1=j?i1.entitySet:i1.navigationProperty;}else{j1=i;}if(h1.indexOf(j1)<0){h1.unshift(j1);if(i1.navigationProperty&&i1.parent){L(i1.parent,j,h1);}}}function N(i,j){var h1=[];L(i,j,h1);return h1;}function O(j){var h1=N(j);h1.pop();var i1="";var j1="";var k1=[];for(var i=0;i<h1.length;i++){i1=i1+j1+h1[i];k1.push(i1);j1="/";}return k1;}function Q(){var i=T.oNavigationControllerProxy.oHashChanger.getHash();var j=i.split("?")[0];var h1=j.split("/");if(h1[0]===""||h1[0]==="#"){h1.splice(0,1);}return h1;}function S(i,j,h1){if(T.oFlexibleColumnLayoutHandler){return T.oFlexibleColumnLayoutHandler.adaptBreadCrumbUrl(i,j,h1);}return i;}function U(){var j=T.oNavigationControllerProxy.getActiveComponents();var h1=0;var i1;for(var i=0;i<j.length;i++){var j1=T.componentRegistry[j[i]];if(j1.viewLevel>0&&(h1===0||j1.viewLevel<h1)){h1=j1.viewLevel;i1=j1.oComponent;}}var k1=i1?Promise.resolve(i1):T.oNavigationControllerProxy.getRootComponentPromise();return k1.then(function(l1){return l1.getModel("i18n").getResourceBundle();});}function V(){return T.oNavigationControllerProxy.getAppTitle();}function W(i,j){T.oNavigationControllerProxy.subTitleForViewLevelChanged(i,j);}function X(i){return T.oNavigationControllerProxy.getCurrentKeys(i);}function Y(){for(var i in T.componentRegistry){var j=T.componentRegistry[i];if(j.viewLevel===1){if(k(j.oComponent)){var h1=j.oComponent.getComponentContainer().getElementBinding();return h1&&h1.getPath();}else{return null;}}}return null;}function Z(h1,i1,j1,k1,l1){var m1=j1.oComponent.getEntitySet();var n1=T.mEntityTree[m1];var o1=false;var p1;var q1=true;for(var i=0;i<n1.children.length&&!p1;i++){var r1=n1.children[i];var s1=T.mEntityTree[r1];if(s1.navigationProperty===h1){p1=s1.sRouteName;q1=!s1.noKey;}}if(k1&&!p1){var t1=n1.embeddedComponents[k1];if(t1){for(var j=0;j<t1.pages.length&&!o1;j++){var u1=t1.pages[j];if(u1.navigationProperty===h1){o1=true;p1=m1+"/"+k1+"/"+h1;q1=!(u1.routingSpec&&u1.routingSpec.noKey);}}}}if(p1){var v1=o1?k1+r.getPatternDelimiter():"";var w1=q1?"("+i1+")":"";var x1=v1+h1+w1;T.oNavigationControllerProxy.navigateToSuffix(x1,j1.viewLevel+1,p1,l1);}}var $;function _(i){var j=i.getEntitySet();var h1=T.mEntityTree[j];if(h1&&h1.communicationModel){return h1.communicationModel;}$=$||new J();return $;}var a1;function b1(j,h1){var i=h1||0;if(i>0){return null;}var i1=j.getEntitySet();var j1=T.mEntityTree[i1];var k1=j1&&j1.communicationObject;for(;i<0&&k1;){j1=T.mEntityTree[j1.parent];if(j1.communicationObject!==k1){i++;k1=j1.communicationObject;}}if(i<0||k1){return k1;}a1=a1||{};return a1;}function c1(i){for(var j in T.mEntityTree){if(T.mEntityTree[j].navigationProperty&&(T.mEntityTree[j].level===i+1)){return T.mEntityTree[j].navigationProperty;}}}function d1(){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getMaxColumnCountInFCL():false;}function e1(){var j=T.oNavigationControllerProxy.getActiveComponents();for(var i=0;i<j.length;i++){var h1=j[i];var i1=T.componentRegistry[h1];var j1=i1.methods.currentDraftModified&&i1.methods.currentDraftModified();if(j1){o.markDraftAsModified(j1);}}}function f1(){if(E!==undefined){return E;}var i,j,h1,i1,j1,k1,l1=true;var m1=T.oAppComponent.getModel();var n1=m1.getMetaModel();var o1=m1.mContexts;for(h1 in o1){l1=false;j1=o1[h1].sPath;i1=j1&&j1.substring(1,j1.indexOf('('));k1=i1&&n1.getODataEntitySet(i1);if(k1){i=m1.getProperty(j1);j=i&&m1.getETag(undefined,undefined,i)||null;if(j){E=true;return E;}}}if(l1){return true;}E=false;return E;}function g1(){var i,j,h1;var i1=T.oNavigationControllerProxy.getAllComponents();for(i=0;i<i1.length;i++){j=i1[i];h1=T.componentRegistry[j];h1.utils.refreshBinding();}}T.oApplicationProxy={getDraftSiblingPromise:o.getDraftSiblingPromise,getAlternativeContextPromise:o.getAlternativeContextPromise,getPathOfLastShownDraftRoot:o.getPathOfLastShownDraftRoot,getResourceBundleForEditPromise:U,getHierarchySectionsFromCurrentHash:Q,getContentDensityClass:g,setEditableNDC:y,getDialogFragment:n.bind(null,null),destroyView:function(i){delete F[i];},setListReportTable:s,markCurrentDraftAsModified:e1,prepareDeletion:K};return{setEditableNDC:y,getEditableNDC:function(){return x;},getContentDensityClass:g,attachControlToParent:f,getDialogFragmentForView:n,getBusyHelper:function(){return T.oBusyHelper;},performAfterSideEffectExecution:p,isComponentActive:k,showMessageToast:function(){var i=arguments;var j=function(){q.sap.log.info("Show message toast");M.show.apply(M,i);};Promise.all([u(true),T.oBusyHelper.getUnbusy()]).then(j);},setBackNavigation:v,getFclProxyForView:w,isNewHistoryEntryRequired:z,registerStateChanger:R,getDraftSiblingPromise:o.getDraftSiblingPromise,registerContext:o.registerContext,activationStarted:o.activationStarted,cancellationStarted:o.cancellationStarted,editingStarted:o.editingStarted,getTargetAfterCancelPromise:G,getBreadCrumbInfo:O,adaptBreadCrumbUrl:S,getSections:N,getHierarchySectionsFromCurrentHash:Q,getAppTitle:V,subTitleForViewLevelChanged:W,getCurrentKeys:X,getPathForViewLevelOneIfVisible:Y,getCommunicationModel:_,getCommunicationObject:b1,navigateRoute:Z,getForwardNavigationProperty:c1,getMaxColumnCountInFCL:d1,getListReportTable:h,markCurrentDraftAsModified:e1,checkEtags:f1,unbindAllComponents:g1,getIsDraftModified:o.getIsDraftModified,prepareDeletion:d.prepareDeletion.bind(null,T),prepareDeletionOfCreateDraft:d.prepareDeletionOfCreateDraft.bind(null,T)};}return B.extend("sap.suite.ui.generic.template.lib.Application",{constructor:function(T){q.extend(this,e(T));}});});
